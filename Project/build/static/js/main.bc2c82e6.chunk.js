(this["webpackJsonpdata-vis"]=this["webpackJsonpdata-vis"]||[]).push([[0],{275:function(t,e,a){},276:function(t,e,a){"use strict";a.r(e);var n=a(3),r=a(0),c=a.n(r),o=a(10),i=a.n(o),l=a(19),u=a(8),s=a(4),d=a(315),p=a.p+"static/media/data_displacement_compare.6efee98a.csv",b=a.p+"static/media/data_gdp.ebea6884.csv",f=a.p+"static/media/data_refugee.037bf479.csv",h=a(14),j=a.n(h),m=a(117),v=a(119);function O(){return(O=Object(m.a)(j.a.mark((function t(){var e,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.k)("/countries-110m.json");case 2:return e=t.sent,a=Object(v.a)(e,e.objects.countries),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var g=function(){var t=Object(r.useState)("Portugal"),e=Object(l.a)(t,2),a=e[0],n=e[1],c=Object(r.useState)(2019),o=Object(l.a)(c,2),i=o[0],h=o[1],j=Object(r.useState)({}),m=Object(l.a)(j,2),v=m[0],g=m[1],y=Object(r.useState)({}),x=Object(l.a)(y,2),C=x[0],w=x[1],W=Object(r.useState)({}),N=Object(l.a)(W,2),I=N[0],M=N[1],k=Object(r.useState)([]),D=Object(l.a)(k,2),S=D[0],Y=D[1];Object(r.useEffect)((function(){Object(s.d)(f).then((function(t){return Object(d.a)((function(t){return t.country}))(t)})).catch((function(t){return console.error("Failed to load refugee data",t),{}})).then((function(t){return g(t)})),Object(s.d)(p).then((function(t){return Object(d.a)((function(t){return t.country}))(t)})).catch((function(t){return console.error("Failed to load displacement data",t),{}})).then((function(t){return w(t)})),Object(s.d)(b).then((function(t){return Object(d.a)((function(t){return t.year}))(t)})).catch((function(t){return console.error("Failed to load GDP data",t),{}})).then((function(t){return M(t)})),function(){return O.apply(this,arguments)}().then((function(t){return Y(t)}))}),[]);var T,B=v[a]||{},P=C[a]||[];return{selectedCountry:a,setSelectedCountry:n,selectedYear:i,setSelectedYear:h,selectedCountryBarChartData:(T=B,Object.values(T).map((function(t){return{label:t.year,value:parseInt(t.total)}})).sort((function(t,e){return parseInt(t.label)-parseInt(e.label)}))),selectedCountryTornadoChartData:function(t){var e,a=[],n=Object(u.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,c={label:r.year,value:parseInt(r.disaster_displacement)},o={label:r.year,value:-parseInt(r.conflict_displacement)};a.push(c),a.push(o)}}catch(i){n.e(i)}finally{n.f()}return a}(P),countriesData:S,gdpDataByYear:I[i]||[]}};function y(t,e,a){var n=document.getElementById(a);n.innerHTML=e,n.style.display="block",n.style.left=t.pageX+10+"px",n.style.top=t.pageY+10+"px"}function x(t){document.getElementById(t).style.display="none"}var C=Object(s.f)(",d"),w=Object(s.f)("~s"),W=40,N=40,I=40,M=40,k=400-M-N,D=400-W-I;var S=function(t){var e=t.data;Object(r.useEffect)((function(){e&&e.length&&function(t){Object(s.u)("#barChart").remove();var e=Object(s.u)(".barChartWidgetWrapper").append("svg").attr("id","barChart").attr("width",k+M+N).attr("height",D+W+I).append("g").attr("transform","translate("+M+","+W+")"),a=Object(s.o)().range([0,k]).padding(.1),n=Object(s.p)().range([D,0]);a.domain(t.map((function(t){return t.label}))),n.domain([0,Object(s.l)(t,(function(t){return t.value}))]),e.selectAll(".bar").data(t).enter().append("rect").attr("class","bar").attr("x",(function(t){return a(t.label)})).attr("width",a.bandwidth()).attr("y",(function(t){return n(t.value)})).attr("height",(function(t){return D-n(t.value)})).on("mousemove",(function(t,e){return y(t,"Number of Outgoing Refugees (in ".concat(e.label,"): ").concat(C(e.value)),"barChartTooltip")})).on("mouseout",(function(){return x("barChartTooltip")})),e.append("g").attr("transform","translate(0,"+D+")").call(Object(s.b)(a));var r=Object(s.c)(n);r.tickFormat((function(t){return w(t)})),e.append("g").call(r)}(e)}),[e])},Y=function(t){var e=t.id,a=t.items;Object(r.useEffect)((function(){!function(t){var e=t.id,a=t.items,n=Object(s.u)("#".concat(e));a.forEach((function(t,e){!function(t,e,a){t.append("circle").attr("cx",100).attr("cy",30*(a+1)).attr("r",6).style("fill",e.color),t.append("text").attr("x",120).attr("y",30*(a+1)).text(e.label).style("font-size","15px").attr("alignment-baseline","middle")}(n,t,e)}))}({id:e,items:a})}),[e,a])},T=function(t){var e=t.id,a=t.items,r=void 0===a?[]:a;return Y({id:e,items:r}),Object(n.jsx)("div",{className:"legendWrapper",children:Object(n.jsx)("svg",{id:e,width:500,height:50+25*r.length})})},B=[{label:"Number of Outgoing Refugees (Per Year)",color:"var(--blue1)"}],P=function(t){var e=t.data,a=void 0===e?[]:e;return S({data:a}),a.length?Object(n.jsxs)("div",{className:"widgetWithLegend",children:[Object(n.jsx)("div",{className:"barChartWidgetWrapper",children:Object(n.jsx)("div",{id:"barChartTooltip",display:"none",style:{position:"absolute",display:"none"}})}),Object(n.jsx)(T,{id:"barChartLegend",items:B})]}):Object(n.jsx)("div",{className:"emptyPlaceholder",children:Object(n.jsx)("p",{children:"No data found for this country"})})},A=40,L=40,_=40,E=40,z=400-E-L,F=400-A-_;var U=function(t){var e=t.data;Object(r.useEffect)((function(){if(e&&e.length){var t=function(){Object(s.u)("#tornadoChart").remove();var t=Object(s.p)().range([0,z]),e=Object(s.o)().rangeRound([0,F]).padding(.1),a=Object(s.b)().scale(t).ticks(7),n=Object(s.c)().scale(e).tickSize(0),r=Object(s.u)(".tornadoChartWidgetWrapper").append("svg").attr("id","tornadoChart").attr("width",z+E+L).attr("height",F+A+_).append("g").attr("transform","translate("+E+","+A+")");return function(c){c.each((function(c){t.domain(Object(s.e)(c,(function(t){return t.value}))).nice(),e.domain(c.map((function(t){return t.label})));var o=Math.min.apply(Math,c.map((function(t){return t.value})));n.tickPadding(Math.abs(t(o)-t(0))+10),a.tickFormat((function(t){return w(Math.abs(t))})),r.selectAll(".tornadoBar").data(c).enter().append("rect").attr("class",(function(t){return"tornadoBar --tornadoBar-"+(t.value<0?"negative":"positive")})).attr("x",(function(e){return t(Math.min(0,e.value))})).attr("y",(function(t){return e(t.label)})).attr("width",(function(e){return Math.abs(t(e.value)-t(0))})).attr("height",e.bandwidth()).on("mousemove",(function(t,e){var a=e.value<0?"Number of Conflict Displacements":"Number of Disaster Displacements";return y(t,"".concat(a," (in ").concat(e.label,"): ").concat(C(Math.abs(e.value))),"barChartTooltip")})).on("mouseout",(function(){return x("barChartTooltip")})),r.append("g").attr("class","x axis").attr("transform","translate(0,"+F+")").call(a),r.append("g").attr("class","y axis").attr("transform","translate("+t(0)+",0)").call(n)}))}}();Object(s.u)(".tornadoChartWidgetWrapper").datum(e).call(t)}}),[e])},H=[{label:"Number of Conflict Displacements (Per Year)",color:"var(--blue4)"},{label:"Number of Disaster Displacements (Per Year)",color:"var(--blue3)"}],R=function(t){var e=t.data,a=void 0===e?[]:e;return U({data:a}),a.length?Object(n.jsxs)("div",{className:"widgetWithLegend",children:[Object(n.jsx)("div",{className:"tornadoChartWidgetWrapper",children:Object(n.jsx)("div",{id:"tornadoChartTooltip",display:"none",style:{position:"absolute",display:"none"}})}),Object(n.jsx)(T,{id:"tornadoChartLegend",items:H})]}):Object(n.jsx)("div",{className:"emptyPlaceholder",children:Object(n.jsx)("p",{children:"No data found for this country"})})},G=a(120),q=a(316);function J(t,e){return((Object(d.a)((function(t){return t.country}))(t)[e.properties.name]||[])[0]||{gdp:""}).gdp}function X(t){var e=t.setSelectedCountry,a=t.countries,n=t.gdpData,r=t.selectedYear,c=Object(s.u)("#map").attr("width",600).attr("height",400),o=Object(s.g)().scale(80).translate([300,400/1.4]),i=Object(s.h)(o),l=c.append("g"),u=Object(s.q)([].concat(Object(G.a)(s.t[4]),["var(--darkGrey)"]));u.domain(["Low Income","Middle Income","Upper Middle Income","High Income","Unknown"]),l.selectAll("path").data(a.features).enter().append("path").attr("class","country").attr("d",i).attr("fill",(function(t){var e=function(t){var e=Math.round(parseInt(t));return e<1026?"Low Income":1026<e&&e<3995?"Middle Income":3995<e&&e<12375?"Upper Middle Income":e?"High Income":"Unknown"}(J(n,t));return u(e)})).on("click",(function(t,a){e(a.properties.name)})).on("mousemove",(function(t,e){var a=J(n,e);return y(t,"".concat(e.properties.name," \u2014 GDP (").concat(r,"): ").concat(a?"$".concat(C(Math.round(parseInt(a)))):"Unknown"),"mapChartTooltip")})).on("mouseout",(function(){return x("mapChartTooltip")}))}var $=function(t){return function(t){var e=t.countries,a=t.gdpData,n=t.selectedYear,c=t.setSelectedCountry;Object(r.useEffect)((function(){!Object(q.a)(e)&&a.length&&X({countries:e,gdpData:a,setSelectedCountry:c,selectedYear:n})}),[e,a,c,n])}({selectedYear:t.selectedYear,setSelectedCountry:t.setSelectedCountry,gdpData:t.gdpData,countries:t.countries}),Object(n.jsx)("div",{className:"widgetWithLegend",children:Object(n.jsxs)("div",{className:"mapWidgetWrapper",children:[Object(n.jsx)("div",{id:"mapChartTooltip",display:"none",style:{position:"absolute",display:"none"}}),Object(n.jsx)("svg",{id:"map"})]})})},K=a(21),Q=a.p+"static/media/data_displacement_category.68e32f18.csv",V=360,Z=360;function tt(){var t=Math.min(V,Z)/2-5,e=Object(s.p)().range([0,2*Math.PI]).clamp(!0),a=Object(s.r)().range([.1*t,t]),n=Object(s.q)(s.s),r=Object(s.m)(),c=Object(s.a)().startAngle((function(t){return e(t.x0)})).endAngle((function(t){return e(t.x1)})).innerRadius((function(t){return Math.max(0,a(t.y0))})).outerRadius((function(t){return Math.max(0,a(t.y1))})),o=function(t){var n=Math.PI/2,r=[e(t.x0)-n,e(t.x1)-n],c=Math.max(0,(a(t.y0)+a(t.y1))/2),o=(r[1]+r[0])/2,i=o>0&&o<Math.PI;i&&r.reverse();var l=Object(s.n)();return l.arc(0,0,c,r[0],r[1],i),l.toString()},i=function(t){var n=e(t.x1)-e(t.x0),r=Math.max(0,(a(t.y0)+a(t.y1))/2)*n;return 6*t.data.name.length<r},l=Object(s.u)(".sunBurstChartWidgetWrapper").append("svg").style("width",V).style("height",Z).attr("viewBox","".concat(-180," ").concat(-180," ").concat(V," ").concat(Z)).on("click",(function(){return u()}));function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x0:0,x1:1,y0:0,y1:1},n=l.transition().duration(750).tween("scale",(function(){var n=Object(s.j)(e.domain(),[t.x0,t.x1]),r=Object(s.j)(a.domain(),[t.y0,1]);return function(t){e.domain(n(t)),a.domain(r(t))}}));function r(t){l.selectAll(".slice").filter((function(e){return e===t})).each((function(t){this.parentNode.appendChild(this),t.parent&&r(t.parent)}))}n.selectAll("path.main-arc").attrTween("d",(function(t){return function(){return c(t)}})),n.selectAll("path.hidden-arc").attrTween("d",(function(t){return function(){return o(t)}})),n.selectAll("text").attrTween("display",(function(t){return function(){return i(t)?null:"none"}})),r(t)}Object(s.d)(Q).then((function(t){var e=Object(d.a)((function(t){return t.country})),a=Object(d.a)((function(t){return t.hazard_category})),n=Object(d.a)((function(t){return t.hazard_type})),r=a(t);return{name:"Displacement Category",children:Object.keys(r).map((function(t){return{name:t,children:r[t]}})).map((function(t){var e=n(t.children),a=Object.keys(e).map((function(t){return{name:t,children:e[t]}}));return Object(K.a)(Object(K.a)({},t),{},{children:a})})).map((function(t){return Object(K.a)(Object(K.a)({},t),{},{children:t.children.map((function(t){var a=e(t.children),n=Object.keys(a).map((function(t){return{name:t,children:a[t]}})).map((function(t){return Object(K.a)(Object(K.a)({},t),{},{children:t.children.map((function(t){return{name:t.year,size:parseInt(t.new_displacements)}}))})}));return Object(K.a)(Object(K.a)({},t),{},{children:n})}))})}))}})).catch((function(t){return console.error("Failed to load displacement data",t),{}})).then((function(t){(t=Object(s.i)(t)).sum((function(t){return t.size}));var e=l.selectAll("g.slice").data(r(t).descendants());e.exit().remove();var a=e.enter().append("g").attr("class","slice").on("click",(function(t,e){t.stopPropagation(),u(e)}));a.append("path").attr("class","main-arc").style("fill",(function(t){return n((t.children?t:t.parent).data.name)})).attr("d",c).on("mousemove",(function(t,e){return y(t,"".concat(e.data.name,": ").concat(C(e.value)),"sunBurstChartTooltip")})).on("mouseout",(function(){return x("sunBurstChartTooltip")})),a.append("path").attr("class","hidden-arc").attr("id",(function(t,e){return"hiddenArc".concat(e)})).attr("d",o),a.append("text").attr("display",(function(t){return i(t)?null:"none"})).append("textPath").attr("startOffset","50%").attr("xlink:href",(function(t,e){return"#hiddenArc".concat(e)})).text((function(t){return t.data.name}))})).catch((function(t){throw t}))}var et=function(){return Object(r.useEffect)((function(){tt()}),[]),Object(n.jsx)("div",{className:"widgetWithLegend",children:Object(n.jsx)("div",{className:"sunBurstChartWidgetWrapper",children:Object(n.jsx)("div",{id:"sunBurstChartTooltip",display:"none",style:{position:"absolute",display:"none"}})})})},at=function(t){var e=t.countryName;return Object(n.jsxs)("h4",{children:["Selected Country: ",e]})},nt=a(319),rt=a(317),ct=a(312),ot=a(314),it=a(309),lt=a(318),ut=[{value:2019,label:"2019"},{value:2018,label:"2018"},{value:2017,label:"2017"},{value:2016,label:"2016"},{value:2015,label:"2015"},{value:2014,label:"2014"},{value:2013,label:"2013"},{value:2012,label:"2012"},{value:2011,label:"2011"},{value:2010,label:"2010"},{value:2009,label:"2009"}],st=Object(it.a)((function(){return Object(lt.a)({formControl:{minWidth:120}})})),dt=function(t){var e=t.selectedYear,a=t.setSelectedYear,r=st();return Object(n.jsxs)(ct.a,{className:r.formControl,children:[Object(n.jsx)(nt.a,{id:"year-select-label",children:"Year"}),Object(n.jsx)(ot.a,{labelId:"year-select-label",id:"year-select",value:e,onChange:function(t){return a(t.target.value)},children:ut.map((function(t){var e=t.value,a=t.label;return Object(n.jsx)(rt.a,{value:e,children:a},e)}))})]})},pt=s.t[4],bt=[{label:"High Income",color:pt[3]},{label:"Middle High Income",color:pt[2]},{label:"Middle Income",color:pt[1]},{label:"Low Income",color:pt[0]},{label:"Unknown",color:"var(--darkGrey)"}];var ft=function(){var t=g(),e=t.selectedCountryBarChartData,a=t.selectedCountryTornadoChartData,r=t.setSelectedCountry,c=t.selectedCountry,o=t.selectedYear,i=t.setSelectedYear,l=t.countriesData,u=t.gdpDataByYear;return Object(n.jsxs)("div",{className:"rootWrapper",children:[Object(n.jsxs)("div",{className:"upperWidgetsWrapper",children:[Object(n.jsxs)("div",{className:"headerWrapper",children:[Object(n.jsxs)("div",{className:"controlsWrapper",children:[Object(n.jsx)(at,{countryName:c}),Object(n.jsx)(dt,{selectedYear:o,setSelectedYear:i})]}),Object(n.jsx)("div",{className:"mapLegendWrapper",children:Object(n.jsx)(T,{id:"mapChartWidget",items:bt})})]}),Object(n.jsx)($,{setSelectedCountry:r,selectedYear:o,countries:l,gdpData:u})]}),Object(n.jsxs)("div",{className:"lowerWidgetsWrapper",children:[Object(n.jsx)(P,{data:e}),Object(n.jsx)(R,{data:a}),Object(n.jsx)(et,{})]})]})};a(275);i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(ft,{})}),document.getElementById("root"))}},[[276,1,2]]]);
//# sourceMappingURL=main.bc2c82e6.chunk.js.map